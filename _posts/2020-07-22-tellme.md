---
title: "TellMe - A Simple Web Application with Django"
date: 2020-07-22
tags: [python, django, sqlite, webapp]
header:
  image: "/images/tellme/tellme.png"
excerpt: "Django, Python, SQLite"
mathjax: "true"
---


[IN PROGRESS]

I created an anonymous Question-Answer platform where people can ask a question or submit their own answers or advices using _Django_. Although I am fan of _Flask_ for creating HTTP services that renders templates, for more complex and larger web applications Django provides _Model-View-Controller_ framework and _data models_. I will share my steps to create a simple web application with _Django_. You can find the completed project on my [GitHub](https://github.com/pinarkaymaz6/tellme) profile. 


Home View             |  Detail View
:-------------------------:|:-------------------------:
![]({{ site.url }}{{ site.baseurl }}/images/tellme/index.png)  |  ![]({{ site.url }}{{ site.baseurl }}/images/tellme/detail.png)

### 1. Create a Django project and an application
  - Create a root folder for the project, e.g. called `tellme`
  ```shell
  mkdir tellme
  ```
  - Create a file called `requirements.txt` which keeps the Python dependency list in the root directory. Add _Django_ to the file.
  ```shell
  cd tellme
  touch requirements.txt
  echo "Django==3.0.8" >> requirements.txt
  ```
  - Create a virtual environment
  ```shell
  python3 -m venv env
  source env/bin/activate
  pip install -r requirements.txt
  ```
  Now that the virtual environment is activated, I can refer to `Python 3` by only `python` from now on. 
  - Create the initial structure of a _Django_ project
  ```shell
  django-admin startproject webapp
  cd webbapp
  python manage.py startapp tellme
  ```
  - Start the application
  ```shell
  python manage.py runserver
  ```
  There are couple of things going on here when you first run this command. Firstly, this created `db.sqlite3` file which is the local database for the project. Also, we see this message below in the output:  
  ```You have 17 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions. Run 'python manage.py migrate' to apply them.```  
  For now, this is normal. Now check your application at [http://127.0.0.1:8000/tellme/](http://127.0.0.1:8000/tellme/) which serves a default page.

### 2. Create models and populate the database
Now we can take care of the message before. 
  - Go to `models.py` and create two models `Question` and `Answer`.  

    ```python
    class Question(models.Model):
      q_title = models.CharField(max_length=100)
      q_text = models.CharField(max_length=300)
      q_date = models.DateTimeField('Date published')

    class Answer(models.Model):
      a_text = models.CharField(max_length=300)
      a_date = models.DateTimeField('Date published')
      a_votes = models.IntegerField(default=0)
      question = models.ForeignKey(Question, on_delete=models.CASCADE)
    ```
  - Now stop the app if you haven't (`CTRL + C`) and "make migrations" which creates new migrations based on the changes you made to your models.  
  ```shell
  python manage.py makemigrations tellme
  ```
  It says `No installed app with label 'tellme'`. This is because you have to add the app in _INSTALLED\_APPS_
  - Go to `webapp/settings.py` and add `tellme` in _INSTALLED\_APPS_ and run the command above again.
  - Run the "migrate" command which creates `tellme/migrations` folder.
  ```shell
  python manage.py migrate
  ```
  - Now we can populate the database. Open the _Django_ shell.
  ```shell
  python manage.py shell
  ```
  - Add a question
  ```console
  import django
  from tellme.models import Question, Answer
  from django.utils import timezone
  django.setup()
  q= Question(q_title = "Best gift for a gamer?",q_text="I am looking for cool gift ideas for my fiance who likes video games.", q_date=timezone.now())
  q.save()
  Question.objects.all()
  ```

  This should print `<QuerySet [<Question: Question object (1)>]>`. You can add a `__str__` method to the models which will help you print more details. Just remember to quit the _Django_ shell (`exit()`) and start again after you make changes to the models.

  - While still inside the _Django_ shell, create answers for our question.
  ```console
  q=Question.objects.get(pk=1)
  q.choice_set.create(a_text = "You can buy a full desk mousepad",a_date=timezone.now(), a_votes=0)
  q.save()
  exit()
  ```

### 3. Admin Tool
  - In order to acces admin tool, we need to set up login.
  ```shell
  python manage.py createsuperuser
  ``` 
  It ask for your login information. Enter your username, email address and password. 
  - Now start the app again (`python manage.py runserver`). Go to [http://127.0.0.1:8000/admin](http://127.0.0.1:8000/admin). It shows Users and Groups. But we want to see Questions and Answers. 
  ![alt]({{ site.url }}{{ site.baseurl }}/images/tellme/admin_ug.png)
  - Go to `admin.py` and register `Question` and `Answer` models.  

    ```python
    from django.contrib import admin
    from .models import Question, Answer

    admin.site.register(Question)
    admin.site.register(Answer)
    ```
  - Now check [http://127.0.0.1:8000/admin](http://127.0.0.1:8000/admin) again. 
  
    ![alt]({{ site.url }}{{ site.baseurl }}/images/tellme/admin_qa.png) 

  - Click on `Questions` and it shows the question we added. Then click on `ADD QUESTION` to add new questions.
  - Now come back to the admin page and navigate to `Answers` to add new answers. When you add a new answer, you should link it to the question that you are answering. 

### 4. 